#!/usr/bin/python
import sys
from scapy.all import *

# function to hold all port scanning activities
def port_scan():
    source_ip = sys.argv[1]                                                                 
    dest_ip = sys.argv[2]
    dest_port = sys.argv[3]
    ip_packet = IP(src=source_ip, dst=dest_ip)
    TCP_SYN_packet = TCP(sport=RandShort(), dport=int(dest_port), flags='S', seq=100)
    TCP_SYNACK_reply = sr1(ip_packet/TCP_SYN_packet,timeout=1)
    if TCP_SYNACK_reply is None:
        print "\nPort " + dest_port + " is closed on host " + dest_ip
    if TCP_SYNACK_reply and TCP_SYNACK_reply[TCP].flags == 18:
        print "\nPort " + dest_port + " is OPEN on host " + dest_ip
def usage():
    print "[*] USAGE: python ./scanner.py [source_ip] [dest_ip] [dest_port]\n"

def main():
    usage()
    port_scan()
if __name__ == '__main__':
    if len(sys.argv) > 4 or len(sys.argv) < 4:
        print "Rerun with correct command line arguments..."
        print "Exiting"
        sys.exit(1)
    else:
        main()
#EOF